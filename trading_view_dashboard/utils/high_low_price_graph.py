from utils.matplotlib_util import plot
from utils.fetch_util import fetch_data_from_api


def high_low_price_graph(
        symbol: str,
        max_days: int = 20,
        price: str = 'high'
):

    # Fetch data from the API
    data = fetch_data_from_api(
        f'https://raw.githubusercontent.com/codershubinc/trade_data/refs/heads/main/high_low/{symbol}.json')

    # Check if the data is empty
    if not data or 'Time Series (Daily)' not in data:
        return "No data available for the given symbol."
    # Extract dates, high prices, and low prices
    dates = []
    high_prices = []
    low_prices = []
    for date, prices in data['Time Series (Daily)'].items():
        dates.append(date)
        high_prices.append(float(prices['2. high']))
        low_prices.append(float(prices['3. low']))

    dates.reverse()
    high_prices.reverse()
    low_prices.reverse()

    max_days = 20
    dates = dates[:max_days]
    high_prices = high_prices[:max_days]
    low_prices = low_prices[:max_days]

    # Generate the plot
    plot_image = plot(
        x_axis_data=dates,
        y_axis_data=high_prices if price == 'high' else low_prices,
        title=f"High Prices for {symbol}" if price == 'high' else f"Low Prices for {symbol}",
        x_label="Date",
        y_label="Price",
        color='green',
        marker='^',
        linestyle='--'
    )

    return plot_image


demo_data = {
    "Meta Data": {
        "1. Information": "Daily Prices (open, high, low, close) and Volumes",
        "2. Symbol": "AAME",
        "3. Last Refreshed": "2025-04-02",
        "4. Output Size": "Compact",
        "5. Time Zone": "US/Eastern"
    },
    "Time Series (Daily)": {
        "2025-04-02": {
            "1. open": "1.5900",
            "2. high": "1.8200",
            "3. low": "1.4800",
            "4. close": "1.5800",
            "5. volume": "38572"
        },
        "2025-04-01": {
            "1. open": "1.6500",
            "2. high": "1.8400",
            "3. low": "1.5600",
            "4. close": "1.5600",
            "5. volume": "12701"
        },
        "2025-03-31": {
            "1. open": "1.6488",
            "2. high": "1.7800",
            "3. low": "1.6187",
            "4. close": "1.7000",
            "5. volume": "21177"
        },
        "2025-03-28": {
            "1. open": "1.7450",
            "2. high": "1.7450",
            "3. low": "1.7200",
            "4. close": "1.7200",
            "5. volume": "1017"
        },
        "2025-03-27": {
            "1. open": "1.7400",
            "2. high": "1.7900",
            "3. low": "1.7400",
            "4. close": "1.7500",
            "5. volume": "8221"
        },
        "2025-03-26": {
            "1. open": "1.7300",
            "2. high": "1.8500",
            "3. low": "1.6974",
            "4. close": "1.7300",
            "5. volume": "20282"
        },
        "2025-03-25": {
            "1. open": "1.3000",
            "2. high": "1.7800",
            "3. low": "1.2477",
            "4. close": "1.7800",
            "5. volume": "44891"
        },
        "2025-03-24": {
            "1. open": "1.3700",
            "2. high": "1.3700",
            "3. low": "1.3700",
            "4. close": "1.3700",
            "5. volume": "421"
        },
        "2025-03-21": {
            "1. open": "1.4200",
            "2. high": "1.4500",
            "3. low": "1.3100",
            "4. close": "1.3700",
            "5. volume": "17375"
        },
        "2025-03-20": {
            "1. open": "1.3500",
            "2. high": "1.5500",
            "3. low": "1.3201",
            "4. close": "1.4400",
            "5. volume": "16732"
        },
        "2025-03-19": {
            "1. open": "1.4000",
            "2. high": "1.4200",
            "3. low": "1.4000",
            "4. close": "1.4000",
            "5. volume": "7896"
        },
        "2025-03-18": {
            "1. open": "1.4300",
            "2. high": "1.4300",
            "3. low": "1.4200",
            "4. close": "1.4200",
            "5. volume": "4666"
        },
        "2025-03-17": {
            "1. open": "1.4000",
            "2. high": "1.5200",
            "3. low": "1.4000",
            "4. close": "1.4600",
            "5. volume": "8957"
        },
        "2025-03-14": {
            "1. open": "1.4400",
            "2. high": "1.4400",
            "3. low": "1.4150",
            "4. close": "1.4300",
            "5. volume": "2517"
        },
        "2025-03-13": {
            "1. open": "1.4500",
            "2. high": "1.4500",
            "3. low": "1.4000",
            "4. close": "1.4000",
            "5. volume": "1922"
        },
        "2025-03-12": {
            "1. open": "1.4500",
            "2. high": "1.4563",
            "3. low": "1.4000",
            "4. close": "1.4500",
            "5. volume": "4524"
        },
        "2025-03-11": {
            "1. open": "1.5350",
            "2. high": "1.5350",
            "3. low": "1.4200",
            "4. close": "1.4500",
            "5. volume": "3660"
        },
        "2025-03-10": {
            "1. open": "1.3500",
            "2. high": "1.6000",
            "3. low": "1.3500",
            "4. close": "1.5600",
            "5. volume": "3596"
        },
        "2025-03-07": {
            "1. open": "1.4300",
            "2. high": "1.4600",
            "3. low": "1.4100",
            "4. close": "1.4100",
            "5. volume": "5233"
        },
        "2025-03-06": {
            "1. open": "1.4000",
            "2. high": "1.5135",
            "3. low": "1.4000",
            "4. close": "1.4800",
            "5. volume": "1455"
        },
        "2025-03-05": {
            "1. open": "1.4780",
            "2. high": "1.4800",
            "3. low": "1.4780",
            "4. close": "1.4800",
            "5. volume": "925"
        },
        "2025-03-04": {
            "1. open": "1.4500",
            "2. high": "1.4799",
            "3. low": "1.4500",
            "4. close": "1.4500",
            "5. volume": "7004"
        },
        "2025-03-03": {
            "1. open": "1.4000",
            "2. high": "1.5000",
            "3. low": "1.4000",
            "4. close": "1.4800",
            "5. volume": "2439"
        },
        "2025-02-28": {
            "1. open": "1.5400",
            "2. high": "1.5400",
            "3. low": "1.5400",
            "4. close": "1.5400",
            "5. volume": "827"
        },
        "2025-02-27": {
            "1. open": "1.5700",
            "2. high": "1.5701",
            "3. low": "1.5200",
            "4. close": "1.5200",
            "5. volume": "2267"
        },
        "2025-02-26": {
            "1. open": "1.5700",
            "2. high": "1.6400",
            "3. low": "1.5700",
            "4. close": "1.6000",
            "5. volume": "3037"
        },
        "2025-02-25": {
            "1. open": "1.5800",
            "2. high": "1.6350",
            "3. low": "1.5700",
            "4. close": "1.5900",
            "5. volume": "4456"
        },
        "2025-02-24": {
            "1. open": "1.5700",
            "2. high": "1.5700",
            "3. low": "1.5700",
            "4. close": "1.5700",
            "5. volume": "468"
        },
        "2025-02-21": {
            "1. open": "1.5700",
            "2. high": "1.6400",
            "3. low": "1.5700",
            "4. close": "1.5700",
            "5. volume": "1311"
        },
        "2025-02-20": {
            "1. open": "1.6591",
            "2. high": "1.6591",
            "3. low": "1.5800",
            "4. close": "1.5800",
            "5. volume": "1506"
        },
        "2025-02-19": {
            "1. open": "1.5700",
            "2. high": "1.6140",
            "3. low": "1.5700",
            "4. close": "1.6050",
            "5. volume": "3894"
        },
        "2025-02-18": {
            "1. open": "1.6025",
            "2. high": "1.6400",
            "3. low": "1.6000",
            "4. close": "1.6000",
            "5. volume": "1558"
        },
        "2025-02-14": {
            "1. open": "1.6150",
            "2. high": "1.6150",
            "3. low": "1.5970",
            "4. close": "1.6000",
            "5. volume": "638"
        },
        "2025-02-13": {
            "1. open": "1.6900",
            "2. high": "1.7000",
            "3. low": "1.6496",
            "4. close": "1.6496",
            "5. volume": "872"
        },
        "2025-02-12": {
            "1. open": "1.6100",
            "2. high": "1.6100",
            "3. low": "1.5700",
            "4. close": "1.5900",
            "5. volume": "1574"
        },
        "2025-02-11": {
            "1. open": "1.6586",
            "2. high": "1.6586",
            "3. low": "1.6100",
            "4. close": "1.6100",
            "5. volume": "4950"
        },
        "2025-02-10": {
            "1. open": "1.7200",
            "2. high": "1.7200",
            "3. low": "1.5776",
            "4. close": "1.6058",
            "5. volume": "18146"
        },
        "2025-02-07": {
            "1. open": "1.7100",
            "2. high": "1.7100",
            "3. low": "1.6108",
            "4. close": "1.6820",
            "5. volume": "3374"
        },
        "2025-02-06": {
            "1. open": "1.6600",
            "2. high": "1.7100",
            "3. low": "1.6004",
            "4. close": "1.7095",
            "5. volume": "4473"
        },
        "2025-02-05": {
            "1. open": "1.6700",
            "2. high": "1.6700",
            "3. low": "1.6220",
            "4. close": "1.6700",
            "5. volume": "2815"
        },
        "2025-02-04": {
            "1. open": "1.7073",
            "2. high": "1.7180",
            "3. low": "1.6400",
            "4. close": "1.7000",
            "5. volume": "9121"
        },
        "2025-02-03": {
            "1. open": "1.6600",
            "2. high": "1.7100",
            "3. low": "1.6020",
            "4. close": "1.6300",
            "5. volume": "3841"
        },
        "2025-01-31": {
            "1. open": "1.7126",
            "2. high": "1.7699",
            "3. low": "1.6000",
            "4. close": "1.6900",
            "5. volume": "2318"
        },
        "2025-01-30": {
            "1. open": "1.7495",
            "2. high": "1.7500",
            "3. low": "1.6100",
            "4. close": "1.7200",
            "5. volume": "3578"
        },
        "2025-01-29": {
            "1. open": "1.6900",
            "2. high": "1.7250",
            "3. low": "1.5200",
            "4. close": "1.7001",
            "5. volume": "4691"
        },
        "2025-01-28": {
            "1. open": "1.5950",
            "2. high": "1.7000",
            "3. low": "1.5400",
            "4. close": "1.7000",
            "5. volume": "9296"
        },
        "2025-01-27": {
            "1. open": "1.4400",
            "2. high": "1.6500",
            "3. low": "1.4400",
            "4. close": "1.6500",
            "5. volume": "33465"
        },
        "2025-01-24": {
            "1. open": "1.5150",
            "2. high": "1.5150",
            "3. low": "1.5150",
            "4. close": "1.5150",
            "5. volume": "547"
        },
        "2025-01-23": {
            "1. open": "1.4800",
            "2. high": "1.5150",
            "3. low": "1.4800",
            "4. close": "1.5150",
            "5. volume": "1560"
        },
        "2025-01-22": {
            "1. open": "1.5050",
            "2. high": "1.5467",
            "3. low": "1.4850",
            "4. close": "1.5100",
            "5. volume": "8993"
        },
        "2025-01-21": {
            "1. open": "1.4800",
            "2. high": "1.5050",
            "3. low": "1.4800",
            "4. close": "1.5050",
            "5. volume": "1841"
        },
        "2025-01-17": {
            "1. open": "1.5500",
            "2. high": "1.5500",
            "3. low": "1.4760",
            "4. close": "1.4760",
            "5. volume": "1217"
        },
        "2025-01-16": {
            "1. open": "1.5000",
            "2. high": "1.5500",
            "3. low": "1.5000",
            "4. close": "1.5023",
            "5. volume": "2824"
        },
        "2025-01-15": {
            "1. open": "1.4800",
            "2. high": "1.5400",
            "3. low": "1.4800",
            "4. close": "1.5200",
            "5. volume": "6504"
        },
        "2025-01-14": {
            "1. open": "1.4812",
            "2. high": "1.5400",
            "3. low": "1.4800",
            "4. close": "1.5400",
            "5. volume": "2071"
        },
        "2025-01-13": {
            "1. open": "1.4200",
            "2. high": "1.5300",
            "3. low": "1.4200",
            "4. close": "1.5300",
            "5. volume": "5935"
        },
        "2025-01-10": {
            "1. open": "1.5076",
            "2. high": "1.5100",
            "3. low": "1.4850",
            "4. close": "1.4850",
            "5. volume": "4026"
        },
        "2025-01-08": {
            "1. open": "1.4700",
            "2. high": "1.5300",
            "3. low": "1.4651",
            "4. close": "1.5200",
            "5. volume": "1621"
        },
        "2025-01-07": {
            "1. open": "1.5404",
            "2. high": "1.5404",
            "3. low": "1.4444",
            "4. close": "1.5000",
            "5. volume": "11601"
        },
        "2025-01-06": {
            "1. open": "1.4800",
            "2. high": "1.5500",
            "3. low": "1.4600",
            "4. close": "1.4600",
            "5. volume": "16843"
        },
        "2025-01-03": {
            "1. open": "1.5000",
            "2. high": "1.5000",
            "3. low": "1.4600",
            "4. close": "1.5000",
            "5. volume": "3157"
        },
        "2025-01-02": {
            "1. open": "1.5400",
            "2. high": "1.5400",
            "3. low": "1.4700",
            "4. close": "1.4850",
            "5. volume": "1323"
        },
        "2024-12-31": {
            "1. open": "1.4506",
            "2. high": "1.5500",
            "3. low": "1.4506",
            "4. close": "1.5400",
            "5. volume": "4642"
        },
        "2024-12-30": {
            "1. open": "1.4850",
            "2. high": "1.5500",
            "3. low": "1.4700",
            "4. close": "1.5500",
            "5. volume": "11713"
        },
        "2024-12-27": {
            "1. open": "1.4843",
            "2. high": "1.4843",
            "3. low": "1.4843",
            "4. close": "1.4843",
            "5. volume": "276"
        },
        "2024-12-26": {
            "1. open": "1.4600",
            "2. high": "1.5323",
            "3. low": "1.4600",
            "4. close": "1.4967",
            "5. volume": "1492"
        },
        "2024-12-24": {
            "1. open": "1.4850",
            "2. high": "1.5000",
            "3. low": "1.4701",
            "4. close": "1.4850",
            "5. volume": "1410"
        },
        "2024-12-23": {
            "1. open": "1.4710",
            "2. high": "1.5100",
            "3. low": "1.4710",
            "4. close": "1.5100",
            "5. volume": "2107"
        },
        "2024-12-20": {
            "1. open": "1.5100",
            "2. high": "1.5500",
            "3. low": "1.4600",
            "4. close": "1.4800",
            "5. volume": "6522"
        },
        "2024-12-19": {
            "1. open": "1.5046",
            "2. high": "1.5201",
            "3. low": "1.5000",
            "4. close": "1.5100",
            "5. volume": "2165"
        },
        "2024-12-18": {
            "1. open": "1.5300",
            "2. high": "1.5300",
            "3. low": "1.4500",
            "4. close": "1.4500",
            "5. volume": "4801"
        },
        "2024-12-17": {
            "1. open": "1.4600",
            "2. high": "1.5500",
            "3. low": "1.4500",
            "4. close": "1.5500",
            "5. volume": "9089"
        },
        "2024-12-16": {
            "1. open": "1.5500",
            "2. high": "1.5500",
            "3. low": "1.5000",
            "4. close": "1.5000",
            "5. volume": "616"
        },
        "2024-12-13": {
            "1. open": "1.5000",
            "2. high": "1.5000",
            "3. low": "1.5000",
            "4. close": "1.5000",
            "5. volume": "1429"
        },
        "2024-12-12": {
            "1. open": "1.5500",
            "2. high": "1.5500",
            "3. low": "1.4900",
            "4. close": "1.5300",
            "5. volume": "4410"
        },
        "2024-12-11": {
            "1. open": "1.5050",
            "2. high": "1.5300",
            "3. low": "1.4800",
            "4. close": "1.4800",
            "5. volume": "1918"
        },
        "2024-12-10": {
            "1. open": "1.5500",
            "2. high": "1.5500",
            "3. low": "1.4900",
            "4. close": "1.5500",
            "5. volume": "4760"
        },
        "2024-12-09": {
            "1. open": "1.5175",
            "2. high": "1.5400",
            "3. low": "1.4860",
            "4. close": "1.5300",
            "5. volume": "2220"
        },
        "2024-12-06": {
            "1. open": "1.5198",
            "2. high": "1.5500",
            "3. low": "1.4650",
            "4. close": "1.5470",
            "5. volume": "4261"
        },
        "2024-12-05": {
            "1. open": "1.5100",
            "2. high": "1.5100",
            "3. low": "1.4500",
            "4. close": "1.4600",
            "5. volume": "7614"
        },
        "2024-12-04": {
            "1. open": "1.5000",
            "2. high": "1.5000",
            "3. low": "1.5000",
            "4. close": "1.5000",
            "5. volume": "581"
        },
        "2024-12-03": {
            "1. open": "1.4800",
            "2. high": "1.5200",
            "3. low": "1.4800",
            "4. close": "1.4800",
            "5. volume": "1988"
        },
        "2024-12-02": {
            "1. open": "1.5600",
            "2. high": "1.5600",
            "3. low": "1.5000",
            "4. close": "1.5200",
            "5. volume": "5944"
        },
        "2024-11-29": {
            "1. open": "1.5400",
            "2. high": "1.5500",
            "3. low": "1.5200",
            "4. close": "1.5200",
            "5. volume": "1896"
        },
        "2024-11-27": {
            "1. open": "1.5900",
            "2. high": "1.6222",
            "3. low": "1.4950",
            "4. close": "1.5600",
            "5. volume": "7699"
        },
        "2024-11-26": {
            "1. open": "1.5300",
            "2. high": "1.6000",
            "3. low": "1.4611",
            "4. close": "1.5300",
            "5. volume": "10335"
        },
        "2024-11-25": {
            "1. open": "1.6800",
            "2. high": "1.7600",
            "3. low": "1.2600",
            "4. close": "1.5800",
            "5. volume": "43293"
        },
        "2024-11-22": {
            "1. open": "1.6399",
            "2. high": "1.6399",
            "3. low": "1.6399",
            "4. close": "1.6399",
            "5. volume": "1589"
        },
        "2024-11-21": {
            "1. open": "1.5700",
            "2. high": "1.6300",
            "3. low": "1.5300",
            "4. close": "1.6300",
            "5. volume": "2652"
        },
        "2024-11-20": {
            "1. open": "1.5799",
            "2. high": "1.6500",
            "3. low": "1.5400",
            "4. close": "1.5900",
            "5. volume": "5646"
        },
        "2024-11-19": {
            "1. open": "1.6200",
            "2. high": "1.6600",
            "3. low": "1.5500",
            "4. close": "1.6000",
            "5. volume": "6316"
        },
        "2024-11-18": {
            "1. open": "1.6000",
            "2. high": "1.7100",
            "3. low": "1.6000",
            "4. close": "1.7000",
            "5. volume": "2865"
        },
        "2024-11-15": {
            "1. open": "1.6750",
            "2. high": "1.7050",
            "3. low": "1.6700",
            "4. close": "1.6700",
            "5. volume": "4820"
        },
        "2024-11-14": {
            "1. open": "1.7200",
            "2. high": "1.7200",
            "3. low": "1.7000",
            "4. close": "1.7000",
            "5. volume": "1311"
        },
        "2024-11-13": {
            "1. open": "1.7600",
            "2. high": "1.7600",
            "3. low": "1.6800",
            "4. close": "1.7150",
            "5. volume": "3065"
        },
        "2024-11-12": {
            "1. open": "1.6700",
            "2. high": "1.6900",
            "3. low": "1.6106",
            "4. close": "1.6900",
            "5. volume": "2756"
        },
        "2024-11-11": {
            "1. open": "1.7100",
            "2. high": "1.7500",
            "3. low": "1.6750",
            "4. close": "1.6750",
            "5. volume": "4249"
        },
        "2024-11-08": {
            "1. open": "1.8100",
            "2. high": "1.8100",
            "3. low": "1.6600",
            "4. close": "1.6924",
            "5. volume": "5372"
        },
        "2024-11-07": {
            "1. open": "1.6346",
            "2. high": "1.7200",
            "3. low": "1.6346",
            "4. close": "1.6502",
            "5. volume": "3727"
        },
        "2024-11-06": {
            "1. open": "1.6186",
            "2. high": "1.7100",
            "3. low": "1.6055",
            "4. close": "1.6731",
            "5. volume": "9935"
        }
    }
}
